# 多线程

### 祭出前辈的博客

[这是一份全面 & 详细的Android多线程知识总结指南](https://juejin.im/post/5d12c1c66fb9a07ee30e2821)

### 大纲

* 多线程基础知识
* Android 多线程实现方式
* 基础使用
  * 继承Thread类
  * 实现Runnable接口
  * Handler
* 复合使用
  * AsyncTask
  * HandlerThread
  * IntentService
* 高级使用
  * 线程池 ThreadPool
* 对比
* 其他
  * 线程同步 Synchronized
  * 线程变量 ThreadLocal
* 总结

### 1. 多线程基础知识

祭出前辈分享的知识汇总
[Android多线程：你必须要了解的多线程基础知识汇总](https://www.jianshu.com/p/7a8cb20cfd80)

on the way

### 2. Android 多线程实现方式

* 基础使用
  * 继承Thread类
  * 实现Runnable接口
  * Handler
* 复合使用
  * AsyncTask
  * HandlerThread
  * IntentService
* 高级使用
  * 线程池 ThreadPool

### 3.基础使用

### 4. 复合使用

Android多线程实现的复合使用包括

* AsyncTask
* HandlerThread
* IntentService

称为“复用”的主要原因是：这三种方法的本质原理都是Android多线程实现（继承Thread类、实现Runnable接口、Handler）的组合实现

#### 4.1 AsyncTask

##### 简介

* 定义
  * 一个Android已封装好的轻量级异步类
  * 属于抽象类 即使用时需要实现子类
* 作用
  * 实现多进程
    * 在工作线程中执行任务 如耗时任务
  * 异步通信、消息传递
    * 实现工作线程&主线程（UI线程）之间的通信
* 优点
  * 方便实现异步通信
    * 不需要使用“任务线程（如继承Thread类）+Handler的复杂组合”
  * 节省资源
    * 内部采用线程池的缓存线程+复用线程，避免了频繁创建&销毁线程所带来的系统资源开销

#### 4.2 HandlerThread

##### 简介

* 定义
	* 一个Android已封装好的轻量级异步类
* 作用
	* 实现多进程
		* 在工作线程中执行任务，耗时任务
	* 异步通信、消息传递
		* 实现工作线程&主线程（UI线程）之间的通信
		* 描述：将工作线程的执行结果传递给主线程，从而在主线程中执行相关的UI操作
* 优点
	* 方便实现异步通信
	* 即不需要使用任务。。。那个复杂组合
* 工作原理
	* 通过继承Thread类，快速创建一个带有Looper对象的新工作线程
	* 通过封装Handler类，快速创建Handler&与其他线程进行通信

#### 4.3 IntentService

##### 简介

* 定义
	* Android里的一个多线程封装类
	* 继承service组件
* 作用
	* 处理异步请求&实现多线程
* 使用场景
	* 线程任务需按顺序、在后台执行
	* 最常见的场景，离线下载
	* 不符合多个数据同时请求的场景 所有任务都是在同一个Thread Looper中执行

## 5 高级使用

线程池

#### 5.1 简介

* 定义
	* 一块缓存了一定数量线程的区域
* 作用
	* 复用线程
	* 管理线程
		* 如统一分配 调优 监控
		* 又如 控制线程池的最大并发数
* 优点
	* 降低 因线程创建销毁所带来的性能开销
		* 重用 换存在线程池的线程
	* 提高 线程响应速度 执行效率
		* 重用线程 = 不需创建线程 马上就可执行
		* 管理线程 = 优化线程的执行顺序
			* 避免大量线程间因互相抢占系统资源而导致阻塞现象
	* 提高 对线程的管理度
* 注
	* 传统的多线程方式的问题
		* 每次新建/销毁线程对象消耗资源、响应速度慢
		* 线程缺乏统一管理，容易出现 阻塞情况

## 其他

### 1. 线程同步 Synchronized关键字

* 简介
	* 定义
		* java中的一个关键字
	* 作用
		* 保证同一时刻最多只有一个线程执行 被Synchronized修饰的方法/代码
		* 其他线程必须等待当前线程执行完该方法/代码块后才能执行该方法
	* 使用场景
		* 保证线程安全，解决多线程中的并发同步问题（实现的是阻塞并发）
		* 具体
			* 修饰 实例方法/代码块时，（同步）保护的是同一个对象方法的调用&当前实例类对象

